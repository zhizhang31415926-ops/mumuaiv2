# MuMuAINovel 项目文件结构说明

> 扫描路径：`/workspace`
> 参考来源：`/workspace/README.md` + 实际目录结构

## 0. 升级详情（本次更新：2026-02-13）

### 0.1 功能新增：拆书分析

- 新增拆书分析页面与后端接口，支持书籍内容拆分、结构化分析与结果展示。
- 拆书流程支持按章节/片段处理，便于后续检索与二次生成。

### 0.2 Embedding 接入（拆书项目内）

- 拆书分析支持可选 embedding 写入，用于向量检索与知识召回。
- 关键请求参数：`enable_embedding`、`project_id`、`embedding_chunk_size`。
- 返回字段补充：`embedding_saved_count`（写入数量）、`embedding_error`（写入失败原因）。

### 0.3 入口改造：拆书独立到侧边栏

- 拆书分析从“项目卡片入口”调整为“侧边栏独立入口”，作为独立功能模块。
- 项目页侧栏保留跳转能力，并兼容 `/?view=book-analysis` 视图模式。

### 0.4 稳定性修复

- 修复拆书分析页面白屏问题：`f.map is not a function`。
- 根因：项目列表接口返回分页对象，前端按数组直接 `map` 导致运行时异常。
- 修复方案：在拆书页面对项目列表返回做数组/分页结构兼容解析，并增加页面错误边界，避免页面直接白屏。

### 0.5 关键改动文件（本次）

- `backend/app/api/book_analysis.py`
- `backend/app/services/book_analysis_service.py`
- `backend/app/schemas/book_analysis.py`
- `frontend/src/pages/BookAnalysis.tsx`
- `frontend/src/pages/ProjectList.tsx`
- `frontend/src/pages/ProjectDetail.tsx`
- `frontend/src/App.tsx`
- `frontend/src/components/PageErrorBoundary.tsx`
- `frontend/src/types/index.ts`

### 0.6 使用注意事项

- 拆书分析仍依赖可用的 LLM 配置（如 API Key 与模型配置）。
- 启用 embedding 写入时需提供有效 `project_id`，否则只执行拆书分析不落库向量。

## 1. 项目根目录结构

```text
/workspace
├── .dockerignore
├── .gitattributes
├── .gitignore
├── .github/
│   └── workflows/
│       └── docker-build.yml
├── Dockerfile
├── LICENSE
├── README.md
├── backend/
├── docker-compose.yml
├── frontend/
├── images/
└── my-codex-project/   (当前为空目录)
```

### 1.1 根目录关键文件说明

| 路径 | 作用 |
|---|---|
| `.dockerignore` | Docker 构建时忽略文件规则，减少镜像上下文体积。 |
| `.gitattributes` | Git 属性配置（如换行、文本识别等）。 |
| `.gitignore` | Git 忽略规则，避免构建产物/本地配置误提交。 |
| `.github/workflows/docker-build.yml` | GitHub Actions 自动化构建流程定义（镜像构建相关）。 |
| `Dockerfile` | 项目镜像构建脚本，用于容器化部署。 |
| `docker-compose.yml` | 多服务编排配置（应用 + PostgreSQL 等）。 |
| `LICENSE` | GPL v3 开源协议。 |
| `README.md` | 项目介绍、部署步骤、功能说明、技术栈和维护信息。 |
| `images/` | README 展示截图资源。 |
| `my-codex-project/` | 空目录，非当前业务代码主体。 |

## 2. 后端结构（`backend/`）

```text
backend/
├── .env.example
├── requirements.txt
├── alembic/
│   ├── README
│   ├── postgres/
│   │   ├── env.py
│   │   ├── script.py.mako
│   │   └── versions/
│   └── sqlite/
│       ├── env.py
│       ├── script.py.mako
│       └── versions/
├── alembic-postgres.ini
├── alembic-sqlite.ini
├── app/
│   ├── main.py
│   ├── config.py
│   ├── database.py
│   ├── logger.py
│   ├── api/
│   ├── models/
│   ├── schemas/
│   ├── services/
│   ├── middleware/
│   ├── mcp/
│   ├── constants/
│   └── utils/
└── scripts/
    ├── entrypoint.sh
    ├── init_postgres.sql
    ├── migrate.py
    └── setup_postgres.py
```

### 2.1 后端核心分层职责

| 目录/文件 | 作用 |
|---|---|
| `backend/.env.example` | 后端环境变量模板，包含数据库、模型服务、鉴权等配置项。 |
| `backend/requirements.txt` | Python 依赖清单。 |
| `backend/app/main.py` | FastAPI 启动入口，注册路由和中间件。 |
| `backend/app/config.py` | 全局配置读取与封装。 |
| `backend/app/database.py` | 数据库引擎与会话管理。 |
| `backend/app/logger.py` | 日志初始化与日志格式配置。 |
| `backend/app/api/` | HTTP 路由层（按业务拆分）。 |
| `backend/app/models/` | ORM 数据模型定义（如项目、角色、章节、关系等）。 |
| `backend/app/schemas/` | 请求/响应数据结构（Pydantic）。 |
| `backend/app/services/` | 业务逻辑与 AI 处理流程。 |
| `backend/app/middleware/` | 请求级中间件（鉴权、请求ID等）。 |
| `backend/app/mcp/` | MCP 插件配置、状态同步、统一访问入口。 |
| `backend/app/constants/` | 常量定义（例如提示词分类）。 |
| `backend/app/utils/` | 通用工具（如 SSE 响应封装、数据一致性工具）。 |
| `backend/alembic/` | 数据库迁移体系，分别维护 PostgreSQL 与 SQLite 版本脚本。 |
| `backend/scripts/init_postgres.sql` | PostgreSQL 初始化脚本（扩展、初始能力）。 |
| `backend/scripts/entrypoint.sh` | 容器启动入口脚本。 |
| `backend/scripts/migrate.py` | 迁移执行辅助脚本。 |
| `backend/scripts/setup_postgres.py` | PostgreSQL 环境初始化辅助。 |

### 2.2 API 模块概览（`backend/app/api/`）

该目录按业务域拆分路由，主要包括：

- 用户与认证：`auth.py`、`users.py`、`admin.py`
- 项目与内容生产：`projects.py`、`outlines.py`、`chapters.py`、`polish.py`
- 角色与关系：`characters.py`、`organizations.py`、`relationships.py`、`careers.py`
- 创作增强功能：`inspiration.py`、`foreshadows.py`、`memories.py`
- 配置与模板：`settings.py`、`prompt_templates.py`、`prompt_workshop.py`、`writing_styles.py`
- 系统扩展与其他：`mcp_plugins.py`、`wizard_stream.py`、`changelog.py`、`common.py`

### 2.3 服务层重点（`backend/app/services/`）

`services/`是后端核心逻辑中心，主要包含：

- AI 客户端适配：`ai_clients/`（OpenAI、Gemini、Anthropic）
- AI 提供方抽象：`ai_providers/`（统一 provider 接口层）
- 业务服务：章节重写、剧情扩展、角色状态更新、记忆管理、伏笔管理、导入导出
- MCP 能力：插件工具装载、MCP 测试服务等

## 3. 前端结构（`frontend/`）

```text
frontend/
├── package.json
├── package-lock.json
├── index.html
├── vite.config.ts
├── eslint.config.js
├── tsconfig.json
├── tsconfig.app.json
├── tsconfig.node.json
├── public/
└── src/
    ├── main.tsx
    ├── App.tsx
    ├── App.css
    ├── index.css
    ├── assets/
    ├── components/
    ├── config/
    ├── pages/
    ├── services/
    ├── store/
    ├── types/
    └── utils/
```

### 3.1 前端关键文件说明

| 路径 | 作用 |
|---|---|
| `frontend/package.json` | 前端依赖与脚本入口（Vite/React/TypeScript 生态）。 |
| `frontend/vite.config.ts` | Vite 构建与开发服务配置。 |
| `frontend/eslint.config.js` | 代码规范检查规则。 |
| `frontend/index.html` | SPA 容器页面模板。 |
| `frontend/public/` | 静态资源（logo、赞助图片、群二维码等）。 |
| `frontend/src/main.tsx` | 应用挂载入口。 |
| `frontend/src/App.tsx` | 应用根组件。 |
| `frontend/src/pages/` | 页面级组件（路由目标页面）。 |
| `frontend/src/components/` | 可复用业务组件（阅读器、分析、重写弹窗、进度条等）。 |
| `frontend/src/services/` | API 请求封装与版本/变更日志服务。 |
| `frontend/src/store/` | 全局状态与事件总线。 |
| `frontend/src/types/` | TS 类型定义。 |
| `frontend/src/utils/` | 会话管理、SSE 客户端等工具函数。 |

### 3.2 页面模块概览（`frontend/src/pages/`）

页面覆盖项目主要业务流，包括：

- 登录与鉴权：`Login.tsx`、`AuthCallback.tsx`
- 项目主流程：`ProjectList.tsx`、`ProjectDetail.tsx`、`ProjectWizardNew.tsx`
- 创作资源管理：`Characters.tsx`、`Organizations.tsx`、`Relationships.tsx`、`Careers.tsx`
- 内容生产与处理：`Outline.tsx`、`Chapters.tsx`、`ChapterReader.tsx`、`ChapterAnalysis.tsx`、`Polish.tsx`
- 增强能力：`Inspiration.tsx`、`Foreshadows.tsx`、`PromptTemplates.tsx`、`PromptWorkshop.tsx`
- 系统配置：`Settings.tsx`、`MCPPlugins.tsx`、`UserManagement.tsx`

## 4. 运维与部署相关结构

| 路径 | 说明 |
|---|---|
| `Dockerfile` | 用于构建统一运行镜像。 |
| `docker-compose.yml` | 编排应用服务与数据库服务。 |
| `backend/scripts/init_postgres.sql` | 容器首次启动时数据库初始化脚本（README中有强调）。 |
| `backend/alembic/` | 迁移版本管理，支持 PostgreSQL/SQLite 双通道。 |

## 5. README 与实际结构对照结论

1. README 中给出的结构为简化版，实际项目分层更细（例如 `schemas/`、`mcp/`、`constants/` 等）。
2. 后端已形成典型的 `API -> Services -> Models/Schemas` 分层，迁移系统完整。
3. 前端采用 `pages + components + services + store + utils` 的常见中大型 React 结构。
4. 根目录存在空目录`/workspace/my-codex-project/`，当前不承载业务代码，可视为预留目录。

## 6. 建议的阅读顺序（新成员上手）

1. 先读 `README.md` 了解部署流程和业务定位。
2. 再读 `docker-compose.yml` + `backend/.env.example` 理解运行依赖。
3. 后端从 `backend/app/main.py -> api/ -> services/` 逐层阅读。
4. 前端从 `frontend/src/main.tsx -> App.tsx -> pages/` 进入业务页面。
5. 数据层最后看 `backend/models/` 与 `alembic/*/versions/` 的演化。


## 7. Embedding 功能改造说明（用于后续升级开发）

> 本节聚焦“向量记忆/Embedding”相关的新增与改造点，便于后续扩展模型、排查问题和做兼容升级。

### 7.1 改造目标

1. 支持 Embedding 来源可切换：`local`（本地模型）/`api`（远程 embeddings 接口）。
2. 将 Embedding 配置与写作 LLM 配置解耦，避免复用同一 `api_key/base_url`。
3. 提供项目级“一键重建 Embedding”能力，解决模型切换后的向量维度/语义不一致问题。
4. 为 API 模式优化启动行为：避免服务启动时强制下载本地 embedding 模型。

### 7.2 关键文件与职责

| 路径 | 作用 |
|---|---|
| `backend/app/config.py` | 定义全局默认 Embedding 配置（`default_embedding_*`）。 |
| `backend/app/models/settings.py` | `settings` 表新增 Embedding 字段（模式、provider、model、api_key、api_base_url）。 |
| `backend/app/schemas/settings.py` | 设置接口请求/响应模型新增 Embedding 字段。 |
| `backend/app/api/settings.py` | 读取默认配置时单独返回 Embedding 配置，不再依赖写作 API 字段。 |
| `backend/app/services/memory_service.py` | Embedding 核心逻辑：配置解析、本地模型按需加载、API 向量化、collection 命名隔离。 |
| `backend/app/api/memories.py` | 新增项目 Embedding 重建接口。 |
| `frontend/src/pages/Settings.tsx` | 设置页拆分为“写作 API 配置”和“Embedding 配置”两块独立表单区。 |
| `frontend/src/pages/ProjectDetail.tsx` | 项目页新增“重建 Embedding”按钮与确认流程。 |
| `frontend/src/services/api.ts` | 封装 `rebuildProjectEmbeddings` 前端请求方法。 |
| `backend/alembic/postgres/versions/20260214_0010_b3c7c65d9f21_添加embedding配置字段到settings表.py` | PostgreSQL 迁移脚本：新增 Embedding 配置字段。 |
| `backend/alembic/sqlite/versions/20260214_0011_4f91a2de77bc_添加embedding配置字段到settings表.py` | SQLite 迁移脚本：新增 Embedding 配置字段。 |

### 7.3 配置项（.env / Config）

当前 Embedding 独立配置项如下：

- `DEFAULT_EMBEDDING_MODE`：`local` 或 `api`
- `DEFAULT_EMBEDDING_PROVIDER`：`openai` / `custom`（兼容 OpenAI embeddings 协议）
- `DEFAULT_EMBEDDING_MODEL`：Embedding 模型名（如 `sentence-transformers/...` 或 `Qwen/...`）
- `DEFAULT_EMBEDDING_API_KEY`：Embedding 专用 API Key
- `DEFAULT_EMBEDDING_API_BASE_URL`：Embedding 专用 Base URL（例如 `https://xxx/v1`）

说明：

1. Embedding 配置应与写作模型配置分开维护，避免一个配置改动影响另一路能力。
2. 当 `DEFAULT_EMBEDDING_MODE=api` 时，系统优先使用 Embedding 专用 key/base_url/model。

### 7.4 运行时行为（MemoryService）

`backend/app/services/memory_service.py` 的关键行为：

1. 配置解析入口：`_resolve_embedding_config(...)`
2. API 模式调用：`_embed_texts_with_api(...)`，走 OpenAI 兼容 `/embeddings` 接口。
3. 本地模式调用：`_embed_texts(...)` 内部触发 `_ensure_local_embedding_model()` 按需加载。
4. 集合命名策略：`_build_collection_name(...)`  
   API 模式按 `provider + model` 做命名哈希隔离，避免不同维度向量写入同一集合。

### 7.5 接口与页面入口

1. 设置页入口：`frontend/src/pages/Settings.tsx`
2. 项目页重建入口：`frontend/src/pages/ProjectDetail.tsx`
3. 重建接口：`POST /api/memories/projects/{project_id}/rebuild-embeddings`
4. 前端请求封装：`projectApi.rebuildProjectEmbeddings(id, batchSize=100)` in `frontend/src/services/api.ts`

重建接口参数与约束：

1. `batch_size` 默认 `100`
2. 服务端最小值 `10`
3. 服务端最大值 `500`

### 7.6 升级/扩展建议（后续开发参考）

1. 新增 Embedding Provider 时，优先在 `memory_service.py` 的 provider 解析与 API 调用处扩展，保持 `/embeddings` 兼容优先。
2. 切换 Embedding 模型后，建议执行一次项目级“重建 Embedding”，避免历史向量与新模型不一致。
3. 若引入不同维度模型并共存，必须保留 collection 命名隔离策略，避免查询异常。
4. 变更 `settings` 结构时，同时更新：`models`、`schemas`、`api/settings.py`、两套 Alembic 迁移脚本（PostgreSQL + SQLite）。
5. 若部署环境网络受限，需提前确认本地模式模型可下载或镜像内预置策略（见 `Dockerfile` 的预下载控制逻辑）。

## 8. 附录：纯树形结构

> 扫描路径：`/workspace`
> 说明：已排除`.git/`与空目录`my-codex-project/`，以下为预序遍历树形清单。

```text
/workspace
├── .dockerignore
├── .gitattributes
├── .github/
│   ├── workflows/
│   │   ├── docker-build.yml
├── .gitignore
├── Dockerfile
├── LICENSE
├── README.md
├── backend/
│   ├── .env.example
│   ├── alembic-postgres.ini
│   ├── alembic-sqlite.ini
│   ├── alembic/
│   │   ├── README
│   │   ├── postgres/
│   │   │   ├── .gitkeep
│   │   │   ├── env.py
│   │   │   ├── script.py.mako
│   │   │   ├── versions/
│   │   │   │   ├── 20251226_1008_ee0a189f1532_初始数据库结构.py
│   │   │   │   ├── 20251226_1102_e411428f00c0_初始化预置数据.py
│   │   │   │   ├── 20251227_1541_a7e4408e1d5b_添加system_prompt字段到settings表.py
│   │   │   │   ├── 20260119_1729_6a73f37e9adb_添加伏笔管理表.py
│   │   │   │   ├── 20260127_1404_421237957b27_添加提示词工坊相关表结构.py
│   │   │   │   ├── 20260212_1244_d4d253e3f4c6_添加角色心理状态追踪字段.py
│   │   │   │   ├── 20260214_0010_b3c7c65d9f21_添加embedding配置字段到settings表.py
│   │   ├── sqlite/
│   │   │   ├── .gitkeep
│   │   │   ├── env.py
│   │   │   ├── script.py.mako
│   │   │   ├── versions/
│   │   │   │   ├── 20251226_1322_fbeb1038c728_初始化sqlite数据库.py
│   │   │   │   ├── 20251227_0856_a1b2c3d4e5f6_初始化sqlite预置数据.py
│   │   │   │   ├── 20251227_1700_7899f8d4d839_添加system_prompt字段到settings表.py
│   │   │   │   ├── 20260119_1005_951919659e0f_添加伏笔管理表.py
│   │   │   │   ├── 20260127_1354_927bcb55b756_添加提示词工坊相关表结构.py
│   │   │   │   ├── 20260212_0922_642c76fc69d4_添加角色心理状态追踪字段.py
│   │   │   │   ├── 20260212_1007_d887fd1a30a6_新增角色状态字段.py
│   │   │   │   ├── 20260214_0011_4f91a2de77bc_添加embedding配置字段到settings表.py
│   ├── app/
│   │   ├── __init__.py
│   │   ├── api/
│   │   │   ├── __init__.py
│   │   │   ├── admin.py
│   │   │   ├── auth.py
│   │   │   ├── careers.py
│   │   │   ├── changelog.py
│   │   │   ├── chapters.py
│   │   │   ├── characters.py
│   │   │   ├── common.py
│   │   │   ├── foreshadows.py
│   │   │   ├── inspiration.py
│   │   │   ├── mcp_plugins.py
│   │   │   ├── memories.py
│   │   │   ├── organizations.py
│   │   │   ├── outlines.py
│   │   │   ├── polish.py
│   │   │   ├── projects.py
│   │   │   ├── prompt_templates.py
│   │   │   ├── prompt_workshop.py
│   │   │   ├── relationships.py
│   │   │   ├── settings.py
│   │   │   ├── users.py
│   │   │   ├── wizard_stream.py
│   │   │   ├── writing_styles.py
│   │   ├── config.py
│   │   ├── constants/
│   │   │   ├── prompt_categories.py
│   │   ├── database.py
│   │   ├── init_relationship_types.py
│   │   ├── logger.py
│   │   ├── main.py
│   │   ├── mcp/
│   │   │   ├── __init__.py
│   │   │   ├── config.py
│   │   │   ├── facade.py
│   │   │   ├── status_sync.py
│   │   ├── middleware/
│   │   │   ├── __init__.py
│   │   │   ├── auth_middleware.py
│   │   │   ├── request_id.py
│   │   ├── models/
│   │   │   ├── __init__.py
│   │   │   ├── analysis_task.py
│   │   │   ├── batch_generation_task.py
│   │   │   ├── career.py
│   │   │   ├── chapter.py
│   │   │   ├── character.py
│   │   │   ├── foreshadow.py
│   │   │   ├── generation_history.py
│   │   │   ├── mcp_plugin.py
│   │   │   ├── memory.py
│   │   │   ├── outline.py
│   │   │   ├── project.py
│   │   │   ├── project_default_style.py
│   │   │   ├── prompt_template.py
│   │   │   ├── prompt_workshop.py
│   │   │   ├── regeneration_task.py
│   │   │   ├── relationship.py
│   │   │   ├── settings.py
│   │   │   ├── user.py
│   │   │   ├── writing_style.py
│   │   ├── schemas/
│   │   │   ├── __init__.py
│   │   │   ├── career.py
│   │   │   ├── chapter.py
│   │   │   ├── character.py
│   │   │   ├── foreshadow.py
│   │   │   ├── import_export.py
│   │   │   ├── mcp_plugin.py
│   │   │   ├── outline.py
│   │   │   ├── polish.py
│   │   │   ├── project.py
│   │   │   ├── prompt_template.py
│   │   │   ├── prompt_workshop.py
│   │   │   ├── regeneration.py
│   │   │   ├── relationship.py
│   │   │   ├── settings.py
│   │   │   ├── writing_style.py
│   │   ├── services/
│   │   │   ├── __init__.py
│   │   │   ├── ai_clients/
│   │   │   │   ├── __init__.py
│   │   │   │   ├── anthropic_client.py
│   │   │   │   ├── base_client.py
│   │   │   │   ├── gemini_client.py
│   │   │   │   ├── openai_client.py
│   │   │   ├── ai_config.py
│   │   │   ├── ai_providers/
│   │   │   │   ├── __init__.py
│   │   │   │   ├── anthropic_provider.py
│   │   │   │   ├── base_provider.py
│   │   │   │   ├── gemini_provider.py
│   │   │   │   ├── openai_provider.py
│   │   │   ├── ai_service.py
│   │   │   ├── auto_character_service.py
│   │   │   ├── auto_organization_service.py
│   │   │   ├── career_service.py
│   │   │   ├── career_update_service.py
│   │   │   ├── chapter_context_service.py
│   │   │   ├── chapter_regenerator.py
│   │   │   ├── character_state_update_service.py
│   │   │   ├── foreshadow_service.py
│   │   │   ├── import_export_service.py
│   │   │   ├── json_helper.py
│   │   │   ├── mcp_test_service.py
│   │   │   ├── mcp_tools_loader.py
│   │   │   ├── memory_service.py
│   │   │   ├── oauth_service.py
│   │   │   ├── plot_analyzer.py
│   │   │   ├── plot_expansion_service.py
│   │   │   ├── prompt_service.py
│   │   │   ├── workshop_client.py
│   │   ├── user_manager.py
│   │   ├── user_password.py
│   │   ├── utils/
│   │   │   ├── data_consistency.py
│   │   │   ├── sse_response.py
│   ├── requirements.txt
│   ├── scripts/
│   │   ├── entrypoint.sh
│   │   ├── init_postgres.sql
│   │   ├── migrate.py
│   │   ├── setup_postgres.py
├── docker-compose.yml
├── frontend/
│   ├── .gitignore
│   ├── README.md
│   ├── eslint.config.js
│   ├── index.html
│   ├── package-lock.json
│   ├── package.json
│   ├── public/
│   │   ├── 10.png
│   │   ├── 20.png
│   │   ├── 5.png
│   │   ├── 50.png
│   │   ├── 99.png
│   │   ├── WX.png
│   │   ├── favicon.ico
│   │   ├── logo.svg
│   │   ├── qq.jpg
│   │   ├── vite.svg
│   │   ├── xx.png
│   ├── src/
│   │   ├── App.css
│   │   ├── App.tsx
│   │   ├── assets/
│   │   │   ├── react.svg
│   │   ├── components/
│   │   │   ├── AIProjectGenerator.tsx
│   │   │   ├── AnnotatedText.tsx
│   │   │   ├── AnnouncementModal.tsx
│   │   │   ├── AppFooter.tsx
│   │   │   ├── CardStyles.tsx
│   │   │   ├── ChangelogFloatingButton.tsx
│   │   │   ├── ChangelogModal.tsx
│   │   │   ├── ChapterAnalysis.tsx
│   │   │   ├── ChapterContentComparison.tsx
│   │   │   ├── ChapterReader.tsx
│   │   │   ├── ChapterRegenerationModal.tsx
│   │   │   ├── CharacterCard.tsx
│   │   │   ├── CharacterCareerCard.tsx
│   │   │   ├── ExpansionPlanEditor.tsx
│   │   │   ├── FloatingIndexPanel.tsx
│   │   │   ├── MemorySidebar.tsx
│   │   │   ├── PartialRegenerateModal.tsx
│   │   │   ├── PartialRegenerateToolbar.tsx
│   │   │   ├── ProtectedRoute.tsx
│   │   │   ├── SSELoadingOverlay.tsx
│   │   │   ├── SSEProgressBar.tsx
│   │   │   ├── SSEProgressModal.tsx
│   │   │   ├── SpringFestival.css
│   │   │   ├── SpringFestival.tsx
│   │   │   ├── UserMenu.tsx
│   │   ├── config/
│   │   │   ├── version.ts
│   │   ├── index.css
│   │   ├── main.tsx
│   │   ├── pages/
│   │   │   ├── AuthCallback.tsx
│   │   │   ├── Careers.tsx
│   │   │   ├── ChapterAnalysis.tsx
│   │   │   ├── ChapterReader.tsx
│   │   │   ├── Chapters.tsx
│   │   │   ├── Characters.tsx
│   │   │   ├── Foreshadows.tsx
│   │   │   ├── Inspiration.tsx
│   │   │   ├── Login.tsx
│   │   │   ├── MCPPlugins.tsx
│   │   │   ├── Organizations.tsx
│   │   │   ├── Outline.tsx
│   │   │   ├── Polish.tsx
│   │   │   ├── ProjectDetail.tsx
│   │   │   ├── ProjectList.tsx
│   │   │   ├── ProjectWizardNew.tsx
│   │   │   ├── PromptTemplates.tsx
│   │   │   ├── PromptWorkshop.tsx
│   │   │   ├── Relationships.tsx
│   │   │   ├── Settings.tsx
│   │   │   ├── Sponsor.tsx
│   │   │   ├── UserManagement.tsx
│   │   │   ├── WorldSetting.tsx
│   │   │   ├── WritingStyles.tsx
│   │   ├── services/
│   │   │   ├── api.ts
│   │   │   ├── changelogService.ts
│   │   │   ├── versionService.ts
│   │   ├── store/
│   │   │   ├── eventBus.ts
│   │   │   ├── hooks.ts
│   │   │   ├── index.ts
│   │   ├── types/
│   │   │   ├── index.ts
│   │   ├── utils/
│   │   │   ├── sessionManager.ts
│   │   │   ├── sseClient.ts
│   ├── tsconfig.app.json
│   ├── tsconfig.json
│   ├── tsconfig.node.json
│   ├── vite.config.ts
├── images/
│   ├── 1.png
│   ├── 2.png
│   ├── 3.png
│   ├── 4.png
├── 项目文件结构说明.md
├── 项目文件结构说明-纯树形附录.md
```
